# Finance-AI-chellange
![panel](./asset/panel.png)

# 2025 ê¸ˆìœµ AI Challenge : ê¸ˆìœµ AI ëª¨ë¸ ê²½ìŸ
- ì£¼ì œ : ê¸ˆìœµë³´ì•ˆ ì‹¤ë¬´ì— ì í•©í•œ ê°œë°œ ë°©ë²•ë¡  ë° AI ëª¨ë¸ì„ ë°œêµ´í•˜ê¸° ìœ„í•´ FSKU í‰ê°€ì§€í‘œë¥¼ ê¸°ë°˜ìœ¼ë¡œ AI ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ê²½ìŸ
- ê¸°ê°„ : 2025.08.01 ~ 2025.08.29
- **Private Score : 0.67721 (1st)**

<br />

## TEAM ë›°ì–´ ğŸ§‘â€ğŸ’»ğŸ‘©â€ğŸ’»

| ì´ìƒí˜ | ê¹€ì˜ì§„ | ì¥í¬ì§„ | ì •ìŠ¹ë¯¼ |
| :---: | :---: | :---: | :---: |
| <img src="https://avatars.githubusercontent.com/u/110239629?v=4" width=300> | <img src="https://avatars.githubusercontent.com/u/94896197?v=4" width=300> | <img src="https://avatars.githubusercontent.com/u/105128163?v=4" width=300> | <img src="https://avatars.githubusercontent.com/u/105360496?v=4" width=300> |

<br />

## Library

- ìì„¸í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ./environment ì°¸ê³ 

<br />

## Pipeline
- **RAG system**
  
![RAG_system](./asset/RAG_system.png)

- **LLM system**
  
![LLM_system](./asset/LLM_system.png)

<br />

## Code

- Model download

```bash
python ./model/model_download.py
```

- Preprocessing

```bash
python ./preparing_data/1.\ tech.py
python ./preparing_data/2.\ ISMS.py
python ./preparing_data/3.\ Rag.py
```

- Streamlit

```bash
streamlit run streamlit_app.py
```

- original --> test.csv inference
```bash
original_code/1.\ RAG.ipynb
original_code/2.\ Inference.ipynb
```
<br />

## Model
- RAG ì„ë² ë”© ëª¨ë¸ : "Alibaba-NLP/gte-multilingual-base" (https://huggingface.co/Alibaba-NLP/gte-multilingual-base)
- Reranker ëª¨ë¸ : "BAAI/bge-reranker-v2-m3" (https://huggingface.co/BAAI/bge-reranker-v2-m3)
- LLM ëª¨ë¸ : "K-intelligence/Midm-2.0-Base-Instruct" (https://huggingface.co/K-intelligence/Midm-2.0-Base-Instruct)

<br />

## Dataset
- ISMS PDF : https://isms.kisa.or.kr/main/ispims/notice/ (KISA í•œêµ­ì¸í„°ë„·ì§„í¥ì›)
- Law PDF : https://www.law.go.kr/ (êµ­ê°€ë²•ë ¹ì •ë³´ì„¼í„°)
- Tech dataset (subjective) : Trendyol/Trendyol-Cybersecurity-Instruction-Tuning-Dataset (https://huggingface.co/datasets/Trendyol/Trendyol-Cybersecurity-Instruction-Tuning-Dataset)
- Tech dataset (multiple choice) : https://github.com/cybermetric/CyberMetric (Github) / https://huggingface.co/datasets/tihanyin/CyberMetric (Huggingface)


## ìš”ê¸° ìˆìŠµë‹ˆë‹¤.
- ì™¸ë¶€ ë¬¸ì„œ ë° ê¸ˆìœµë³´ì•ˆ ì§€ì‹ë² ì´ìŠ¤ êµ¬ì¶• ë°©ë²• ë° êµ¬ì¡° ìƒì„¸ ì„¤ëª…
- ì„ë² ë”© ëª¨ë¸ ë° ë²¡í„° DB êµ¬ì„± ë°©ì‹, ë¬¸ì„œ ê²€ìƒ‰ ë° ì§€ì‹ ì¶”ì¶œ ê³¼ì • ê¸°ìˆ 

1. RAG ë°ì´í„° ì…‹ ì„ ì • ê³¼ì •
    - ê¸ˆìœµë³´ì•ˆ ì§ˆë¬¸ì˜ ìœ í˜•ì€ í¬ê²Œ 2ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆì—ˆìŒ
    - 1) ê¸ˆìœµ ê´€ë ¨ ë²•, 2) ì •ë³´ ë³´ì•ˆ ê¸°ìˆ 
    - ë‹¤ìŒê³¼ ê°™ì€ 2ê°œì˜ domain ì—ì„œ RAG documentë¥¼ search
    - 1) ê¸ˆìœµ ê´€ë ¨ ë²•
        - ë²•ì˜ ì°¸ê³  ë¬¸ì„œëŠ” ISMS-P ì¸ì¦ê¸°ì¤€ ì•ˆë‚´ì„œ(2023.11.23.).pdf ì˜ 46p ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì—ˆìŒ + ë˜ ë‹¤ë¥¸ ì •ë³´ë³´ì•ˆ ê´€ë ¨ ë²•ë“¤ì„ ì°¾ì•„ì„œ ë²• PDF ëª¨ìŒì§‘ì„ êµ¬ì¶•
        - test ë°ì´í„°ì™€ ë¹„ìŠ·í•œ domain ìœ¼ë¡œ ì˜ˆì¸¡ë˜ì–´ KISAì˜ ì•ˆë‚´ì„œ 3ê°œë¥¼ RAG ë°ì´í„°ë¡œ ì‚¬ìš© ( ISMS-P ì¸ì¦ê¸°ì¤€ ì•ˆë‚´ì„œ, ISMS-P ì¸ì¦ì œë„ ì•ˆë‚´ì„œ, KISA_í´ë¼ìš°ë“œì„œë¹„ìŠ¤_ë³´ì•ˆì¸ì¦ì œë„_ì•ˆë‚´ì„œ )
        - ** ISMS-P ì¸ì¦ê¸°ì¤€ ì•ˆë‚´ì„œëŠ” ê³µê³µëˆ„ë¦¬ì§‘ 4ìœ í˜•ìœ¼ë¡œ ì¸ìš©ê³¼ chunking ì€ ê°€ëŠ¥í•œ ë¼ì´ì„¼ìŠ¤, ë²• PDF ëŠ” êµ­ê°€ë²•ë ¹ì •ë³´ì„¼í„°ì—ì„œ ë‹¤ìš´ë¡œë“œ **
        - ë²• ëª©ë¡ : ê°€ìƒìì‚° ì´ìš©ì ë³´í˜¸ ë“±ì— ê´€í•œ ë²•ë¥ , ê°œì¸ì •ë³´ ë³´í˜¸ë²•, ê¸ˆìœµ ê¸°ê´€ ê²€ì‚¬ ë° ì œì¬ì— ê´€í•œ ê·œì •, ê¸ˆìœµìœ„ì›íšŒì˜ ì„¤ì¹˜ ë“±ì— ê´€í•œ ë²•ë¥ , ê¸ˆìœµíšŒì‚¬ì˜ ì •ë³´ì²˜ë¦¬ ì—…ë¬´ ìœ„íƒì— ê´€í•œ ê·œì •, ë¶€ì • ê²½ìŸ ë°©ì§€ ë° ì˜ì—… ë¹„ë°€ ë³´í˜¸ì— ê´€í•œ ë²•ë¥ , ì‚¬ì´ë²„ ì•ˆë³´ ì—…ë¬´ ê·œì •, ì‚°ì—…ê¸°ìˆ ì˜ ìœ ì¶œë°©ì§€ ë° ë³´í˜¸ì— ê´€í•œ ë²•ë¥ , ì‚°ì—…í‘œì¤€í™”ë²•, ì†Œë“ì„¸ë²•, ì†Œí”„íŠ¸ì›¨ì–´ ì§„í¥ë²•, ì†Œí”„íŠ¸ì›¨ì–´ ì§„í¥ë²• ì‹œí–‰ë ¹, ì‹ ìš©ì •ë³´ì˜ ì´ìš© ë° ë³´í˜¸ì— ê´€í•œ ë²•ë¥ , ì—¬ì‹ ì „ë¬¸ê¸ˆìœµì—…ë²•, ìœ„ì¹˜ì •ë³´ì˜ ë³´í˜¸ ë° ì´ìš© ë“±ì— ê´€í•œ ë²•ë¥ , ì€í–‰ë²•, ì €ì‘ê¶Œë²•, ì „ê¸°í†µì‹ ì‚¬ì—…ë²•, ì „ìê¸ˆìœµê°ë…ê·œì •, ì „ìê¸ˆìœµê±°ë˜ë²•, ì „ìê¸ˆìœµê±°ë˜ë²• ì‹œí–‰ë ¹, ì „ìë¬¸ì„œ ë° ì „ìê±°ë˜ ê¸°ë³¸ë²•, ì „ììƒê±°ë˜ ë“±ì—ì„œì˜ ì†Œë¹„ìë³´í˜¸ì— ê´€í•œ ë²•ë¥ , ì „ìì„œëª…ë²•, ì „ìì •ë¶€ë²•, ì •ë³´ë³´í˜¸ ê´€ë¦¬ ë“±ê¸‰ ë¶€ì—¬ì— ê´€í•œ ê³ ì‹œ, ì •ë³´ë³´í˜¸ì‚°ì—…ì˜ ì§„í¥ì— ê´€í•œ ë²•ë¥ , ì •ë³´ë³´í˜¸ì‚°ì—…ì˜ ì§„í¥ì— ê´€í•œ ë²•ë¥  ì‹œí–‰ê·œì¹™, ì •ë³´í†µì‹ ê¸°ë°˜ ë³´í˜¸ë²•, ì •ë³´í†µì‹ ë§ ì´ìš©ì´‰ì§„ ë° ì •ë³´ë³´í˜¸ ë“±ì— ê´€í•œ ë²•ë¥ , í´ë¼ìš°ë“œì»´í“¨íŒ… ë°œì „ ë° ì´ìš©ì ë³´í˜¸ì— ê´€í•œ ë²•ë¥ , í†µì‹ ë¹„ë°€ë³´í˜¸ë²•, íŠ¹ì • ê¸ˆìœµê±°ë˜ì •ë³´ì˜ ë³´ê³  ë° ì´ìš© ë“±ì— ê´€í•œ ë²•ë¥  
    - 2) ì •ë³´ ë³´ì•ˆ ê¸°ìˆ 
        - í•œê¸€ë¡œ ëœ ì •ë³´ ë³´ì•ˆ ê¸°ìˆ  ë°ì´í„° ì…‹ì€ ì°¾ì„ ìˆ˜ ì—†ì—ˆìŒ
        - ì˜ì–´ë¡œ í™•ì¥í•˜ì—¬ search í•´ë³¸ ê²°ê³¼ ë‹¤ìŒê³¼ ê°™ì€ 2ê°œì˜ ë°ì´í„° ì…‹ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆìŒ
        - 1. Trendyol-Cybersecurity-Instruction-Tuning-Dataset, 2. cybermetric
        - 1ë²ˆì€ ì£¼ê´€ì‹ QA í—ˆê¹…í˜ì´ìŠ¤ ë°ì´í„°ì…‹, 2ë²ˆì€ ê°ê´€ì‹ QA í—ˆê¹…í˜ì´ìŠ¤ ë°ì´í„°ì…‹ì„

2. ë°ì´í„° ì…‹ ì „ì²˜ë¦¬ ê³¼ì •
    - ì „ì²˜ë¦¬ ê³¼ì •ì€ 3ê°€ì§€ì˜ ê²½ìš°ë¡œ ì„¤ëª…
    - 1) KISA PDF
    - íŠ¹ì§• : ì•ˆë‚´ì„œë¡œ í‘œ, ê·¸ë¦¼, ì•„ì´ì½˜ ë“± ë‹¤ì–‘í•œ ìš”ì†Œë“¤ì´ ìˆëŠ” PDF, textì— noise ê°€ ìˆì„ ìˆ˜ ìˆìŒ
    - ë°©ë²• : ë¨¼ì € PDFplumber ë¥¼ í†µí•´ text ë¥¼ ëª¨ë‘ ì½ê³  ê° page ë§ˆë‹¤ ëŒ€ì‹œë¥˜ í†µì¼ í›„ì— í•œê¸€, ì˜ì–´, ìˆ«ì, ì¼ë¶€ ì˜ˆì™¸ íŠ¹ìˆ˜ ê¸°í˜¸ë¥¼ ì œì™¸í•œ ëª¨ë“  ë¬¸ìë¥¼ ì œê±° --> ì •ë³´ ì†ì‹¤ì´ ìˆì§€ë§Œ noise ë¥¼ ì¤„ì—¬ ì˜ë¯¸ìˆëŠ” ì •ë³´ë“¤ì„ ì‚´ë¦¬ëŠ” ë°©í–¥
    - 2) ë²• PDF
    - íŠ¹ì§• : ì œNì¡°ì˜ Ní•­()ìœ¼ë¡œ text ì˜ í˜•íƒœê°€ ì •í˜•í™” ë˜ì–´ìˆìŒ
    - ë°©ë²• : ì œNì¡°ì˜ Ní•­()ì„ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë“  í•­ ë¶„ë¦¬ í›„ ì•ì— ë²•ì˜ ì´ë¦„ì„ ë¶™í˜ ex) ì „ìê¸ˆìœµê±°ë˜ë²• ì œ1ì¡°(ëª©ì ) ì´ ë²•ì€ ì „ìê¸ˆìœµê±°ë˜ì˜ ...
    - 3) ë³´ì•ˆ í—ˆê¹…í˜ì´ìŠ¤ ë°ì´í„° ì…‹
    - íŠ¹ì§• : ë”°ë¡œ ë…¸ì´ì¦ˆëŠ” ì—†ëŠ” ê¹”ë”í•œ text ë°ì´í„° ì…‹
    - ë°©ë²• : ì£¼ê´€ì‹, ê°ê´€ì‹ ëª¨ë‘ ì§ˆë¬¸ + ì •ë‹µì˜ í˜•íƒœë¡œ ì§ˆë¬¸ê³¼ ì •ë‹µì„ í•˜ë‚˜ì˜ text ë¡œ ì´ì–´ì„œ ì œì‘. ê°ê´€ì‹ì˜ ê²½ìš° ì˜¤ë‹µì€ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ.

3. Chunk êµ¬ì„± ê³¼ì •
    - 1. ì§§ì€ text ë“¤ì€ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ : ë¦¬íŠ¸ë¦¬ë²„ì˜ similarity ê³„ì‚°ì—ì„œ ë°©í•´ë¥¼ ì¤Œ, 100 ì ì´ìƒìœ¼ë¡œ í•„í„°ë§
    - 2. RecursiveCharacterTextSplitterë¡œ Chunk split : size 2000, overlap 500 ê¸°ì¤€ìœ¼ë¡œ \n\n, \n, â€œ â€, â€œâ€ ì„ separators ë¡œ êµ¬ì„±
    - 3. [], <> ë“±ì˜ í•„ìš” ì—†ëŠ” ì„¤ëª… ë¶€ë¶„ ( ì£¼ë¡œ ë²• ) ë¶€ë¶„ ì‚­ì œ í›„ì²˜ë¦¬

4. RAG
    - 1. Embedding ëª¨ë¸ì€ í•œ, ì˜ ëª¨ë‘ë¥¼ ê³ ë ¤ í•  ìˆ˜ ìˆëŠ” model ì„ ì • : 
        Alibaba-NLP/gte-multilingual-base, normalize_embeddings ì‚¬ìš©
    - 2. FAISS vectorDB ì‚¬ìš© : similarity, këŠ” 10

5. Reranking
    - 1. Raranking model ë˜í•œ í•œ, ì˜ ëª¨ë‘ë¥¼ ê³ ë ¤ í•  ìˆ˜ ìˆëŠ” model ì„ ì • :
        BAAI/bge-reranker-v2-m3
    - 2. query ì— ëŒ€í•´ retriver ë¡œ ë‚˜ì˜¨ 10 ê°œì˜ chunk ì— ëŒ€í•´ ëª¨ë‘ Reranking, logit ì²˜ë¦¬ëŠ” sigmoid --> 0~1 ì‚¬ì´ì˜ score ê°€ ë‚˜ì˜¤ê³  ì´ ë•Œ ê°€ì¥ ë†’ì€ score ë¥¼ ë‹¬ì„±í•œ í•˜ë‚˜ì˜ chunkë§Œ ì‚¬ìš©
    - 3. score threshold 0.75 ë¥¼ ë„˜ì§€ ëª»í•œë‹¤ë©´ RAG Chunkë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ